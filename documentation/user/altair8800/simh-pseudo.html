<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Device simh-pseudo - User documentation for emuStudio</title> <link rel="shortcut icon" href="/documentation/user/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/documentation/user/assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-3492956-5"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-3492956-5', { 'anonymize_ip': true }); </script> <script src="/documentation/user/assets/js/vendor/lunr.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mermaid@9.1.6/dist/mermaid.min.js"></script> <script src="/documentation/user/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Device simh-pseudo | User documentation for emuStudio</title> <meta name="generator" content="Jekyll v4.3.1" /> <meta property="og:title" content="Device simh-pseudo" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="User documentation for emuStudio 0.40. emuStudio is universal emulation platform and framework targeting mainly academic sphere." /> <meta property="og:description" content="User documentation for emuStudio 0.40. emuStudio is universal emulation platform and framework targeting mainly academic sphere." /> <link rel="canonical" href="/documentation/user/altair8800/simh-pseudo" /> <meta property="og:url" content="/documentation/user/altair8800/simh-pseudo" /> <meta property="og:site_name" content="User documentation for emuStudio" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Device simh-pseudo" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"User documentation for emuStudio 0.40. emuStudio is universal emulation platform and framework targeting mainly academic sphere.","headline":"Device simh-pseudo","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/documentation/user/assets/logo-1.svg"}},"url":"/documentation/user/altair8800/simh-pseudo"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/documentation/user/" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in Introduction category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/documentation/user/introduction/" class="nav-list-link">Introduction</a><ul class="nav-list "></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in emuStudio Application category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/documentation/user/application/" class="nav-list-link">emuStudio Application</a><ul class="nav-list "><li class="nav-list-item "><a href="/documentation/user/application/configuration-file" class="nav-list-link">Configuration file</a></li><li class="nav-list-item "><a href="/documentation/user/application/opening-computer" class="nav-list-link">Opening a computer</a></li><li class="nav-list-item "><a href="/documentation/user/application/computer-schema" class="nav-list-link">Computer schema</a></li><li class="nav-list-item "><a href="/documentation/user/application/main-window" class="nav-list-link">Main window</a></li><li class="nav-list-item "><a href="/documentation/user/application/automation" class="nav-list-link">Automation</a></li><li class="nav-list-item "><a href="/documentation/user/application/logging" class="nav-list-link">Logging</a></li></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander" aria-label="toggle links in MITS Altair8800 category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/documentation/user/altair8800/" class="nav-list-link">MITS Altair8800</a><ul class="nav-list "><li class="nav-list-item "><a href="/documentation/user/altair8800/as-8080" class="nav-list-link">Assembler as-8080</a></li><li class="nav-list-item "><a href="/documentation/user/altair8800/as-z80" class="nav-list-link">Assembler as-z80</a></li><li class="nav-list-item "><a href="/documentation/user/altair8800/8080-cpu" class="nav-list-link">CPU 8080-cpu</a></li><li class="nav-list-item "><a href="/documentation/user/altair8800/z80-cpu" class="nav-list-link">CPU z80-cpu</a></li><li class="nav-list-item "><a href="/documentation/user/altair8800/standard-mem" class="nav-list-link">Memory standard-mem</a></li><li class="nav-list-item "><a href="/documentation/user/altair8800/88-dcdd" class="nav-list-link">Device 88-dcdd</a></li><li class="nav-list-item "><a href="/documentation/user/altair8800/88-sio" class="nav-list-link">Device 88-sio</a></li><li class="nav-list-item "><a href="/documentation/user/altair8800/adm3a-terminal" class="nav-list-link">Device adm3a-terminal</a></li><li class="nav-list-item active"><a href="/documentation/user/altair8800/simh-pseudo" class="nav-list-link active">Device simh-pseudo</a></li><li class="nav-list-item "><a href="/documentation/user/altair8800/automation" class="nav-list-link">Automation</a></li><li class="nav-list-item "><a href="/documentation/user/altair8800/software" class="nav-list-link">Original software</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in BrainDuck category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/documentation/user/brainduck/" class="nav-list-link">BrainDuck</a><ul class="nav-list "><li class="nav-list-item "><a href="/documentation/user/brainduck/compiler" class="nav-list-link">Compiler "brainc-brainduck"</a></li><li class="nav-list-item "><a href="/documentation/user/brainduck/cpu" class="nav-list-link">CPU "brainduck-cpu"</a></li><li class="nav-list-item "><a href="/documentation/user/brainduck/terminal" class="nav-list-link">Terminal "brainduck-terminal"</a></li><li class="nav-list-item "><a href="/documentation/user/brainduck/automation" class="nav-list-link">Automation</a></li><li class="nav-list-item "><a href="/documentation/user/brainduck/examples" class="nav-list-link">Example code</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in RAM category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/documentation/user/ram/" class="nav-list-link">RAM</a><ul class="nav-list "><li class="nav-list-item "><a href="/documentation/user/ram/ramc-ram" class="nav-list-link">Compiler "ramc-ram"</a></li><li class="nav-list-item "><a href="/documentation/user/ram/ram-cpu" class="nav-list-link">CPU "ram-cpu"</a></li><li class="nav-list-item "><a href="/documentation/user/ram/ram-mem" class="nav-list-link">Memory "ram-mem"</a></li><li class="nav-list-item "><a href="/documentation/user/ram/abstract-tape" class="nav-list-link">Abstract tape</a></li><li class="nav-list-item "><a href="/documentation/user/ram/automation" class="nav-list-link">Automation</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in RASP category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/documentation/user/rasp/" class="nav-list-link">RASP</a><ul class="nav-list "><li class="nav-list-item "><a href="/documentation/user/rasp/raspc-rasp" class="nav-list-link">Compiler "raspc-rasp"</a></li><li class="nav-list-item "><a href="/documentation/user/rasp/rasp-cpu" class="nav-list-link">CPU "rasp-cpu"</a></li><li class="nav-list-item "><a href="/documentation/user/rasp/rasp-mem" class="nav-list-link">Memory "rasp-mem"</a></li><li class="nav-list-item "><a href="/documentation/user/rasp/automation" class="nav-list-link">Automation</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in SSEM category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/documentation/user/ssem/" class="nav-list-link">SSEM</a><ul class="nav-list "><li class="nav-list-item "><a href="/documentation/user/ssem/as-ssem" class="nav-list-link">Assembler "as-ssem"</a></li><li class="nav-list-item "><a href="/documentation/user/ssem/ssem-cpu" class="nav-list-link">CPU "ssem-cpu"</a></li><li class="nav-list-item "><a href="/documentation/user/ssem/ssem-mem" class="nav-list-link">Memory "ssem-mem"</a></li><li class="nav-list-item "><a href="/documentation/user/ssem/ssem-display" class="nav-list-link">Display "ssem-display"</a></li><li class="nav-list-item "><a href="/documentation/user/ssem/automation" class="nav-list-link">Automation</a></li><li class="nav-list-item "><a href="/documentation/user/ssem/software" class="nav-list-link">Software for SSEM</a></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search User documentation for emuStudio" aria-label="Search User documentation for emuStudio" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="/" class="site-button" > Back to website </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/documentation/user/altair8800/">MITS Altair8800</a></li> <li class="breadcrumb-nav-list-item"><span>Device simh-pseudo</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <script type="text/javascript"> gtag('event', 'userdoc', { 'event_category': 'Altair8800', 'event_label': 'Device simh-pseudo' }); </script> <h1 id="pseudo-device-simh-pseudo"> <a href="#pseudo-device-simh-pseudo" class="anchor-heading" aria-labelledby="pseudo-device-simh-pseudo"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Pseudo-device “simh-pseudo” </h1> <p>This device is originally implemented as permanently connected to 88-SIO device in <a href="http://simh.trailing-edge.com/" target="_blank">simh</a> emulator. It listens to custom, non-standard commands from operating system thus simplifies communication between emulator (host) and running guest system. This device is required if you want to run CP/M operating system images made for simh emulator.</p> <h2 id="programming"> <a href="#programming" class="anchor-heading" aria-labelledby="programming"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Programming </h2> <p>SIMH-pseudo device can be pretty useful also for users of emuStudio. Z80 or 8080 programs communicate with it via port <code class="language-plaintext highlighter-rouge">0xFE</code>.</p> <p>Some commands sent to the port require parameters, in which case there must be sent multiple bytes. If a command returns anything, the returned value can be read using <code class="language-plaintext highlighter-rouge">IN</code> instruction.</p> <h3 id="list-of-commands"> <a href="#list-of-commands" class="anchor-heading" aria-labelledby="list-of-commands"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> List of commands </h3> <p>In case of multibyte parameters or return value, if it’s a numeric value it’s always in a form of little endian.</p> <div class="table-wrapper"><table> <thead> <tr> <th>Command</th> <th>Parameters</th> <th>Return value</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>0</td> <td>N/A</td> <td>N/A</td> <td>print the current time on stdout, in milliseconds</td> </tr> <tr> <td>1</td> <td>N/A</td> <td>N/A</td> <td>start a new timer on the top of the timer stack</td> </tr> <tr> <td>2</td> <td>N/A</td> <td>N/A</td> <td>stop timer on top of timer stack and print time difference on stdout, in milliseconds</td> </tr> <tr> <td>3</td> <td>N/A</td> <td>N/A</td> <td>reset the PTR device (NOT IMPLEMENTED)</td> </tr> <tr> <td>4</td> <td>N/A</td> <td>N/A</td> <td>attach the PTR device (NOT IMPLEMENTED)</td> </tr> <tr> <td>5</td> <td>N/A</td> <td>N/A</td> <td>detach the PTR device (NOT IMPLEMENTED)</td> </tr> <tr> <td>6</td> <td>N/A</td> <td>8 bytes (<code class="language-plaintext highlighter-rouge">"SIMH004\0"</code>)</td> <td>get the current version of the SIMH pseudo device</td> </tr> <tr> <td>7</td> <td>N/A</td> <td>6 bytes</td> <td>get the current time in ZSDOS format, all BCD values: byte 0: year modulo 100, byte 1: month, byte 2: day, byte 3: hour, byte 4: minute, byte 5: second</td> </tr> <tr> <td>8</td> <td>2 bytes (address of a 6-byte block in memory representing ZSDOS time in format YY MM DD HH MM SS)</td> <td>N/A</td> <td>set the current time in ZSDOS format: reads the time from given address</td> </tr> <tr> <td>9</td> <td>N/A</td> <td>5 bytes</td> <td>get the current time in CP/M 3 format, all BCD values: bytes 0-1: days since 1 Jan 1978 (low byte), byte 2: hour, byte 3: minute, byte 4: second</td> </tr> <tr> <td>10</td> <td>2 bytes (address of a 5-byte block in memory representing CP/M 3 time in format: 0-1: days since 31 Dec 77, 2: HH, 3: MM, 4: SS)</td> <td>N/A</td> <td>set the current time in CP/M 3 format: reads the time from given address</td> </tr> <tr> <td>11</td> <td>N/A</td> <td>1 byte</td> <td>get the selected bank</td> </tr> <tr> <td>12</td> <td>1 byte</td> <td>N/A</td> <td>set the selected bank</td> </tr> <tr> <td>13</td> <td>N/A</td> <td>2 bytes</td> <td>get the base address of the common memory segment</td> </tr> <tr> <td>14</td> <td>N/A</td> <td>N/A</td> <td>reset the SIMH-pseudo device (clears “undefined” state)</td> </tr> <tr> <td>15</td> <td>N/A</td> <td>N/A</td> <td>show time difference to timer on top of stack</td> </tr> <tr> <td>16</td> <td>N/A</td> <td>1 byte</td> <td>attach PTP device to the file with name at beginning of CP/M command line (NOT IMPLEMENTED)</td> </tr> <tr> <td>17</td> <td>N/A</td> <td>N/A</td> <td>detach PTP device (NOT IMPLEMENTED)</td> </tr> <tr> <td>18</td> <td>N/A</td> <td>1 byte</td> <td>determines whether machine has banked memory (returns number of memory banks)</td> </tr> <tr> <td>19</td> <td>N/A</td> <td>N/A</td> <td>set the CPU to a Z80 (NOT IMPLEMENTED)</td> </tr> <tr> <td>20</td> <td>N/A</td> <td>N/A</td> <td>set the CPU to an 8080 (NOT IMPLEMENTED)</td> </tr> <tr> <td>21</td> <td>N/A</td> <td>N/A</td> <td>start timer interrupts</td> </tr> <tr> <td>22</td> <td>N/A</td> <td>N/A</td> <td>stop timer interrupts</td> </tr> <tr> <td>23</td> <td>2 bytes</td> <td>N/A</td> <td>set the timer interval in which interrupts occur</td> </tr> <tr> <td>24</td> <td>2 bytes</td> <td>N/A</td> <td>set the address to call by timer interrupts</td> </tr> <tr> <td>25</td> <td>N/A</td> <td>N/A</td> <td>reset the millisecond stop watch</td> </tr> <tr> <td>26</td> <td>N/A</td> <td>2 bytes</td> <td>read the millisecond stop watch</td> </tr> <tr> <td>27</td> <td>N/A</td> <td>N/A</td> <td>let emulation sleep for 1000 milliseconds</td> </tr> <tr> <td>28</td> <td>N/A</td> <td>1 byte</td> <td>obtain the file path separator of the OS under which emuStudio runs</td> </tr> <tr> <td>29</td> <td>N/A</td> <td>file names separated by 0, ends with double 0</td> <td>perform wildcard expansion and obtain list of file names</td> </tr> <tr> <td>30</td> <td>URL (N bytes terminated with 0)</td> <td>max 1024 byte pairs (URL content) in form <code class="language-plaintext highlighter-rouge">availability, data</code> (when <code class="language-plaintext highlighter-rouge">availability</code> is 1 the <code class="language-plaintext highlighter-rouge">data</code> byte is valid) until <code class="language-plaintext highlighter-rouge">availability</code> is 0</td> <td>read the contents of a URL</td> </tr> <tr> <td>31</td> <td>N/A</td> <td>2 bytes</td> <td>get the clock frequency of the CPU</td> </tr> <tr> <td>32</td> <td>2 bytes</td> <td>N/A</td> <td>set the clock frequency of the CPU. To make effect, CPU must be paused/run again.</td> </tr> <tr> <td>33</td> <td>2 bytes (byte 0: (unused) interrupt vector, byte 1: interrupt data byte, an <code class="language-plaintext highlighter-rouge">RST</code> instruction)</td> <td>N/A</td> <td>generate interrupt</td> </tr> </tbody> </table></div> <h3 id="how-to-call-a-command"> <a href="#how-to-call-a-command" class="anchor-heading" aria-labelledby="how-to-call-a-command"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> How to call a command </h3> <p>Calling a command always starts with an <code class="language-plaintext highlighter-rouge">OUT</code> instruction:</p> <div class="language-plaintext code-example highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ld  a, &lt;cmd&gt;  ; replace "&lt;cmd&gt;" with command number
out (0xFE), a
</code></pre></div></div> <p>Then, if a command requires a parameter, it must be supplied with additional <code class="language-plaintext highlighter-rouge">OUT</code> instruction(s), depending on how many bytes are expected, as follows:</p> <div class="language-plaintext code-example highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ld a, &lt;param0&gt;  ; replace "&lt;param0&gt;" with parameter byte 0
out (0xFE), a
ld a, &lt;param1&gt;  ; replace "&lt;param1&gt;" with parameter byte 1
out (0xFE), a
...              ; etc.
</code></pre></div></div> <p>After last parameter is recognized by SIMH-pseudo device, the command is executed. Then, if the command returns a result, it must be read with <code class="language-plaintext highlighter-rouge">IN</code> instructions, depending on how many bytes are to be returned, as follows:</p> <div class="language-plaintext code-example highlighter-rouge"><div class="highlight"><pre class="highlight"><code>in a, (0xFE)    ; register A contains first byte of result
...             ; save the byte somewhere
in a, (0xFE)    ; register A contains second byte of result
</code></pre></div></div> <p>Note: The program must send/receive all bytes. Otherwise, the device will stay in a state when it “expects” the rest of parameter bytes, or result bytes to be read. It is however possible to “reset” the device by sending a reset command to the device (command 14).</p> </div> </div> <div class="search-overlay"></div> </div> <script> var config = {} ; mermaid.initialize(config); window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid')); </script> </body> </html>
